@using TerranForum.Domain.Models
@using Microsoft.AspNetCore.Identity
@using TerranForum.Application.Services
@using System.ComponentModel.DataAnnotations
@model Post
@inject SignInManager<ApplicationUser> SignInManager

@foreach (var paragraph in Model.Content.Split("\r\n\r\n"))
{
    <p>@paragraph</p>
}
<div class="container-fluid pb-4">
    <div class="d-flex justify-content-end">
        @Model.User.UserName
    </div>
    <div class="d-flex justify-content-start" postId="@Model.Id" id="ratingModifyContainer">
        <a class="px-2"  
            id="like"
            rating="1"
            asp-controller="Post"
            asp-action="UpdateRating">Like</a>
        <div class="px-1">@Model.Ratings.Sum(x => x.Value)</div>
        <a class="px-2"
            id="dislike"
            rating="-1"
            asp-controller="Post"
            asp-action="UpdateRating">Dislike</a>
    </div>
</div>
<div class="container">
    @foreach (var reply in Model.Replies)
    {
        <div class="container">
            <p>@reply.Content</p>
        </div>
    }
    <div id="createReply">
        @if (SignInManager.IsSignedIn(User))
        {
            <a class="replyAchor" 
                asp-controller="Post" 
                asp-action="GetCreatePostReplyView" 
                postId="@Model.Id" 
                forumId="@Model.ForumId" 
                id="addReply">Add Comment</a>
        }
        else
        {
            <a class="nav-link" asp-area="Identity" asp-page="/Account/Login">Add Comment</a>
        }
    </div>
</div>
